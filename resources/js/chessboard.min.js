!function(){"use strict";var J=window.jQuery,W="abcdefgh".split(""),o=20,F="â€¦",A="1.8.3",e="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",G=ie(e),n=200,t=200,a=60,s=30,i=100,H={};function V(e,r,o){function n(){t=0,a&&(a=!1,i())}var t=0,a=!1,s=[],i=function(){t=window.setTimeout(n,r),e.apply(o,s)};return function(e){s=arguments,t?a=!0:i()}}function Z(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){return(16*Math.random()|0).toString(16)})}function _(e){return JSON.parse(JSON.stringify(e))}function p(e){var r=e.split(".");return{major:parseInt(r[0],10),minor:parseInt(r[1],10),patch:parseInt(r[2],10)}}function ee(e,r){for(var o in r)if(r.hasOwnProperty(o))for(var n="{"+o+"}",t=r[o];-1!==e.indexOf(n);)e=e.replace(n,t);return e}function re(e){return"string"==typeof e}function oe(e){return"function"==typeof e}function c(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function l(e){return"fast"===e||"slow"===e||c(e)&&0<=e}function ne(e){return re(e)&&-1!==e.search(/^[a-h][1-8]$/)}function u(e){return re(e)&&-1!==e.search(/^[bw][KQRNBP]$/)}function te(e){if(!re(e))return!1;e=e.replace(/ .+$/,"");var r=(e=e.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")).split("/");if(8!==r.length)return!1;for(var o=0;o<8;o++)if(8!==r[o].length||-1!==r[o].search(/[^kqrnbpKQRNBP1]/))return!1;return!0}function ae(e){if(!J.isPlainObject(e))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(!ne(r)||!u(e[r])))return!1;return!0}function se(){return window.$,J.fn&&J.fn.jquery&&function(e,r){e=p(e),r=p(r);var o=1e5*e.major*1e5+1e5*e.minor+e.patch;return 1e5*r.major*1e5+1e5*r.minor+r.patch<=o}(J.fn.jquery,A)}function ie(e){if(!te(e))return!1;for(var r,o=(e=e.replace(/ .+$/,"")).split("/"),n={},t=8,a=0;a<8;a++){for(var s=o[a].split(""),i=0,p=0;p<s.length;p++){-1!==s[p].search(/[1-8]/)?i+=parseInt(s[p],10):(n[W[i]+t]=(r=s[p]).toLowerCase()===r?"b"+r.toUpperCase():"w"+r.toUpperCase(),i+=1)}--t}return n}function pe(e){if(!ae(e))return!1;for(var r,o,n="",t=8,a=0;a<8;a++){for(var s=0;s<8;s++){var i=W[s]+t;e.hasOwnProperty(i)?n+=(r=e[i],o=void 0,"w"===(o=r.split(""))[0]?o[1].toUpperCase():o[1].toLowerCase()):n+="1"}7!==a&&(n+="/"),--t}return n=n.replace(/11111111/g,"8").replace(/1111111/g,"7").replace(/111111/g,"6").replace(/11111/g,"5").replace(/1111/g,"4").replace(/111/g,"3").replace(/11/g,"2")}function ce(e,r,o){for(var n=function(e){for(var r=[],o=0;o<8;o++)for(var n=0;n<8;n++){var t=W[o]+(n+1);e!==t&&r.push({square:t,distance:function(e,r){var o=e.split(""),n=W.indexOf(o[0])+1,t=parseInt(o[1],10),a=r.split(""),s=W.indexOf(a[0])+1,i=parseInt(a[1],10),p=Math.abs(n-s),c=Math.abs(t-i);return c<=p?p:c}(e,t)})}r.sort(function(e,r){return e.distance-r.distance});var a=[];for(o=0;o<r.length;o++)a.push(r[o].square);return a}(o),t=0;t<n.length;t++){var a=n[t];if(e.hasOwnProperty(a)&&e[a]===r)return a}return!1}function le(e){var r;return"black"!==e.orientation&&(e.orientation="white"),!1!==e.showNotation&&(e.showNotation=!0),!0!==e.draggable&&(e.draggable=!1),"trash"!==e.dropOffBoard&&(e.dropOffBoard="snapback"),!0!==e.sparePieces&&(e.sparePieces=!1),e.sparePieces&&(e.draggable=!0),e.hasOwnProperty("pieceTheme")&&(re(e.pieceTheme)||oe(e.pieceTheme))||(e.pieceTheme="img/chesspieces/wikipedia/{piece}.png"),l(e.appearSpeed)||(e.appearSpeed=n),l(e.moveSpeed)||(e.moveSpeed=t),l(e.snapbackSpeed)||(e.snapbackSpeed=a),l(e.snapSpeed)||(e.snapSpeed=s),l(e.trashSpeed)||(e.trashSpeed=i),c(r=e.dragThrottleRate)&&1<=r||(e.dragThrottleRate=o),e}H.alpha="alpha-d2270",H.black="black-3c85d",H.board="board-b72b1",H.chessboard="chessboard-63f37",H.clearfix="clearfix-7da63",H.highlight1="highlight1-32417",H.highlight2="highlight2-9c5d2",H.notation="notation-322f9",H.numeric="numeric-fc462",H.piece="piece-417db",H.row="row-5277c",H.sparePieces="spare-pieces-7492f",H.sparePiecesBottom="spare-pieces-bottom-ae20f",H.sparePiecesTop="spare-pieces-top-4028b",H.square="square-55d63",H.white="white-1e1d7",console.assert("abc"===ee("abc",{a:"x"})),console.assert("{a}bc"===ee("{a}bc",{})),console.assert("{a}bc"===ee("{a}bc",{p:"q"})),console.assert("xbc"===ee("{a}bc",{a:"x"})),console.assert("xbcxbc"===ee("{a}bc{a}bc",{a:"x"})),console.assert("xxy"===ee("{a}{a}{b}",{a:"x",b:"y"})),console.assert(ne("a1")),console.assert(ne("e2")),console.assert(!ne("D2")),console.assert(!ne("g9")),console.assert(!ne("a")),console.assert(!0),console.assert(!0),console.assert(!ne({})),console.assert(u("bP")),console.assert(u("bK")),console.assert(u("wK")),console.assert(u("wR")),console.assert(!u("WR")),console.assert(!u("Wr")),console.assert(!u("a")),console.assert(!0),console.assert(!0),console.assert(!u({})),console.assert(te(e)),console.assert(te("8/8/8/8/8/8/8/8")),console.assert(te("r1bqkbnr/pppp1ppp/2n5/1B2p3/4P3/5N2/PPPP1PPP/RNBQK2R")),console.assert(te("3r3r/1p4pp/2nb1k2/pP3p2/8/PB2PN2/p4PPP/R4RK1 b - - 0 1")),console.assert(!te("3r3z/1p4pp/2nb1k2/pP3p2/8/PB2PN2/p4PPP/R4RK1 b - - 0 1")),console.assert(!te("anbqkbnr/8/8/8/8/8/PPPPPPPP/8")),console.assert(!te("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/")),console.assert(!te("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBN")),console.assert(!te("888888/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR")),console.assert(!te("888888/pppppppp/74/8/8/8/PPPPPPPP/RNBQKBNR")),console.assert(!te({})),console.assert(ae(G)),console.assert(ae({})),console.assert(ae({e2:"wP"})),console.assert(ae({e2:"wP",d2:"wP"})),console.assert(!ae({e2:"BP"})),console.assert(!ae({y2:"wP"})),console.assert(!ae(null)),console.assert(!ae("start")),console.assert(!ae(e)),console.assert(pe(G)===e),console.assert("8/8/8/8/8/8/8/8"===pe({})),console.assert("8/8/8/8/8/8/Pp6/8"===pe({a2:"wP",b2:"bP"})),window.Chessboard=function(e,u){if(!function(){if(se())return 1;var e="Chessboard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+A+" or higher on the page\n\nExiting"+F;window.alert(e)}())return null;var r,n=function(e){if(""===e){var r="Chessboard Error 1001: The first argument to Chessboard() cannot be an empty string.\n\nExiting"+F;return window.alert(r),!1}re(e)&&"#"!==e.charAt(0)&&(e="#"+e);var o=J(e);if(1===o.length)return o;var n="Chessboard Error 1003: The first argument to Chessboard() must be the ID of a DOM node, an ID query selector, or a single DOM node.\n\nExiting"+F;return window.alert(n),!1}(e);if(!n)return null;"start"===(r=u)?r={position:_(G)}:te(r)?r={position:ie(r)}:ae(r)&&(r={position:_(r)}),J.isPlainObject(r)||(r={}),u=le(u=r);var t=null,i=null,a=null,s=null,p={},c=2,l="white",d={},f=null,h=null,v=null,g=!1,P={},b={},w={},m=16;function y(e,r,o){if(!0===u.hasOwnProperty("showErrors")&&!1!==u.showErrors){var n="Chessboard Error "+e+": "+r;return"console"===u.showErrors&&"object"==typeof console&&"function"==typeof console.log?(console.log(n),void(2<=arguments.length&&console.log(o))):"alert"===u.showErrors?(o&&(n+="\n\n"+JSON.stringify(o)),void window.alert(n)):void(oe(u.showErrors)&&u.showErrors(e,r,o))}}function x(e){return oe(u.pieceTheme)?u.pieceTheme(e):re(u.pieceTheme)?ee(u.pieceTheme,{piece:e}):(y(8272,"Unable to build image source for config.pieceTheme."),"")}function O(e,r,o){var n='<img src="'+x(e)+'" ';return re(o)&&""!==o&&(n+='id="'+o+'" '),n+='alt="" class="{piece}" data-piece="'+e+'" style="width:'+m+"px;height:"+m+"px;",r&&(n+="display:none;"),ee(n+='" />',H)}function o(e){var r=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(r=["bK","bQ","bR","bB","bN","bP"]);for(var o="",n=0;n<r.length;n++)o+=O(r[n],!1,P[r[n]]);return o}function q(e,r,o){if(0!==e.length)for(var n=0,t=0;t<e.length;t++){var a=e[t];"clear"===a.type?J("#"+b[a.square]+" ."+H.piece).fadeOut(u.trashSpeed,s):"add"!==a.type||u.sparePieces?"add"===a.type&&u.sparePieces?function(e,r,o){var n=J("#"+P[e]).offset(),t=J("#"+b[r]),a=t.offset(),s=Z();J("body").append(O(e,!0,s));var i=J("#"+s);i.css({display:"",position:"absolute",left:n.left,top:n.top});var p={duration:u.moveSpeed,complete:function(){t.find("."+H.piece).remove(),t.append(O(e)),i.remove(),oe(o)&&o()}};i.animate(a,p)}(a.piece,a.square,s):"move"===a.type&&function(e,r,o,n){var t=J("#"+b[e]),a=t.offset(),s=J("#"+b[r]),i=s.offset(),p=Z();J("body").append(O(o,!0,p));var c=J("#"+p);c.css({display:"",position:"absolute",top:a.top,left:a.left}),t.find("."+H.piece).remove();var l={duration:u.moveSpeed,complete:function(){s.append(O(o)),c.remove(),oe(n)&&n()}};c.animate(i,l)}(a.source,a.destination,a.piece,s):J("#"+b[a.square]).append(O(a.piece,!0)).find("."+H.piece).fadeIn(u.appearSpeed,s)}function s(){(n+=1)===e.length&&(k(),oe(u.onMoveEnd)&&u.onMoveEnd(_(r),_(o)))}}function k(){for(var e in t.find("."+H.piece).remove(),d)d.hasOwnProperty(e)&&J("#"+b[e]).append(O(d[e]))}function S(){t.html(function(e){"black"!==e&&(e="white");var r="",o=_(W),n=8;"black"===e&&(o.reverse(),n=1);for(var t="white",a=0;a<8;a++){r+='<div class="{row}">';for(var s=0;s<8;s++){var i=o[s]+n;r+='<div class="{square} '+H[t]+" square-"+i+'" style="width:'+m+"px;height:"+m+'px;" id="'+b[i]+'" data-square="'+i+'">',u.showNotation&&(("white"===e&&1===n||"black"===e&&8===n)&&(r+='<div class="{notation} {alpha}">'+o[s]+"</div>"),0===s&&(r+='<div class="{notation} {numeric}">'+n+"</div>")),r+="</div>",t="white"===t?"black":"white"}r+='<div class="{clearfix}"></div></div>',t="white"===t?"black":"white","white"===e?--n:n+=1}return ee(r,H)}(l,u.showNotation)),k(),u.sparePieces&&("white"===l?(a.html(o("black")),s.html(o("white"))):(a.html(o("white")),s.html(o("black"))))}function T(e){var r=_(d),o=_(e);pe(r)!==pe(o)&&(oe(u.onChange)&&u.onChange(r,o),d=e)}function B(e,r){for(var o in w)if(w.hasOwnProperty(o)){var n=w[o];if(e>=n.left&&e<n.left+m&&r>=n.top&&r<n.top+m)return o}return"offboard"}function C(){t.find("."+H.square).removeClass(H.highlight1+" "+H.highlight2)}function E(){C();var e=_(d);delete e[v],T(e),k(),i.fadeOut(u.trashSpeed),g=!1}function N(e,r,o,n){oe(u.onDragStart)&&!1===u.onDragStart(e,r,_(d),l)||(g=!0,f=r,h="spare"===(v=e)?"offboard":e,function(){for(var e in w={},b)b.hasOwnProperty(e)&&(w[e]=J("#"+b[e]).offset())}(),i.attr("src",x(r)).css({display:"",position:"absolute",left:o-m/2,top:n-m/2}),"spare"!==e&&J("#"+b[e]).addClass(H.highlight1).find("."+H.piece).css("display","none"))}function R(e,r){i.css({left:e-m/2,top:r-m/2});var o=B(e,r);o!==h&&(ne(h)&&J("#"+b[h]).removeClass(H.highlight2),ne(o)&&J("#"+b[o]).addClass(H.highlight2),oe(u.onDragMove)&&u.onDragMove(o,h,v,f,_(d),l),h=o)}function I(e){var r,o,n,t,a,s="drop";"offboard"===e&&"snapback"===u.dropOffBoard&&(s="snapback"),"offboard"===e&&"trash"===u.dropOffBoard&&(s="trash"),oe(u.onDrop)&&(r=_(d),"spare"===v&&ne(e)&&(r[e]=f),ne(v)&&"offboard"===e&&delete r[v],ne(v)&&ne(e)&&(delete r[v],r[e]=f),o=_(d),"snapback"!==(n=u.onDrop(v,e,f,r,o,l))&&"trash"!==n||(s=n)),"snapback"===s?"spare"!==v?(C(),t=J("#"+b[v]).offset(),a={duration:u.snapbackSpeed,complete:function(){k(),i.css("display","none"),oe(u.onSnapbackEnd)&&u.onSnapbackEnd(f,v,_(d),l)}},i.animate(t,a),g=!1):E():"trash"===s?E():"drop"===s&&function(e){C();var r=_(d);delete r[v],r[e]=f,T(r);var o=J("#"+b[e]).offset(),n={duration:u.snapSpeed,complete:function(){k(),i.css("display","none"),oe(u.onSnapEnd)&&u.onSnapEnd(v,e,f)}};i.animate(o,n),g=!1}(e)}function K(e){e.preventDefault()}function M(e){var r;!u.draggable||ne(r=J(this).attr("data-square"))&&d.hasOwnProperty(r)&&N(r,d[r],e.pageX,e.pageY)}function j(e){var r;!u.draggable||ne(r=J(this).attr("data-square"))&&d.hasOwnProperty(r)&&(e=e.originalEvent,N(r,d[r],e.changedTouches[0].pageX,e.changedTouches[0].pageY))}function D(e){u.sparePieces&&N("spare",J(this).attr("data-piece"),e.pageX,e.pageY)}function Q(e){u.sparePieces&&N("spare",J(this).attr("data-piece"),(e=e.originalEvent).changedTouches[0].pageX,e.changedTouches[0].pageY)}p.clear=function(e){p.position({},e)},p.destroy=function(){n.html(""),i.remove(),n.unbind()},p.fen=function(){return p.position("fen")},p.flip=function(){return p.orientation("flip")},p.move=function(){if(0!==arguments.length){for(var e,r=!0,o={},n=0;n<arguments.length;n++){!1!==arguments[n]?!function(e){if(re(e)){var r=e.split("-");if(2===r.length)return ne(r[0])&&ne(r[1])}}(arguments[n])?y(2826,"Invalid move passed to the move method.",arguments[n]):o[(e=arguments[n].split("-"))[0]]=e[1]:r=!1}var t=function(e,r){var o,n=_(e);for(var t in r){r.hasOwnProperty(t)&&n.hasOwnProperty(t)&&(o=n[t],delete n[t],n[r[t]]=o)}return n}(d,o);return p.position(t,r),t}},p.orientation=function(e){return 0===arguments.length?l:"white"===e||"black"===e?(l=e,S(),l):"flip"===e?(l="white"===l?"black":"white",S(),l):void y(5482,"Invalid value passed to the orientation method.",e)},p.position=function(e,r){return 0===arguments.length?_(d):re(e)&&"fen"===e.toLowerCase()?pe(d):(re(e)&&"start"===e.toLowerCase()&&(e=_(G)),te(e)&&(e=ie(e)),void(ae(e)?(!1!==r&&(r=!0),r?(q(function(e,r){e=_(e),r=_(r);var o,n=[],t={};for(var a in r)r.hasOwnProperty(a)&&e.hasOwnProperty(a)&&e[a]===r[a]&&(delete e[a],delete r[a]);for(a in r){r.hasOwnProperty(a)&&((o=ce(e,r[a],a))&&(n.push({type:"move",source:o,destination:a,piece:r[a]}),delete e[o],delete r[a],t[a]=!0))}for(a in r)r.hasOwnProperty(a)&&(n.push({type:"add",square:a,piece:r[a]}),delete r[a]);for(a in e)e.hasOwnProperty(a)&&(t.hasOwnProperty(a)||(n.push({type:"clear",square:a,piece:e[a]}),delete e[a]));return n}(d,e),d,e),T(e)):(T(e),k())):y(6482,"Invalid value passed to the position method.",e)))},p.resize=function(){m=function(){var e=parseInt(n.width(),10);if(!e||e<=0)return 0;for(var r=e-1;r%8!=0&&0<r;)--r;return r/8}(),t.css("width",8*m+"px"),i.css({height:m,width:m}),u.sparePieces&&n.find("."+H.sparePieces).css("paddingLeft",m+c+"px"),S()},p.start=function(e){p.position("start",e)};var X=V(function(e){g&&R(e.pageX,e.pageY)},u.dragThrottleRate),Y=V(function(e){g&&(e.preventDefault(),R(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))},u.dragThrottleRate);function L(e){g&&I(B(e.pageX,e.pageY))}function U(e){g&&I(B(e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY))}function $(e){var r,o;g||!oe(u.onMouseoverSquare)||ne(r=J(e.currentTarget).attr("data-square"))&&(o=!1,d.hasOwnProperty(r)&&(o=d[r]),u.onMouseoverSquare(r,o,_(d),l))}function z(e){var r,o;g||!oe(u.onMouseoutSquare)||ne(r=J(e.currentTarget).attr("data-square"))&&(o=!1,d.hasOwnProperty(r)&&(o=d[r]),u.onMouseoutSquare(r,o,_(d),l))}return l=u.orientation,u.hasOwnProperty("position")&&("start"===u.position?d=_(G):te(u.position)?d=ie(u.position):ae(u.position)?d=_(u.position):y(7263,"Invalid value passed to config.position.",u.position)),function(){var e,r;!function(){for(var e=0;e<W.length;e++)for(var r=1;r<=8;r++){var o=W[e]+r;b[o]=o+"-"+Z()}for(var n="KQRNBP".split(""),e=0;e<n.length;e++){var t="w"+n[e],a="b"+n[e];P[t]=t+"-"+Z(),P[a]=a+"-"+Z()}}(),n.html((e=u.sparePieces,r='<div class="{chessboard}">',e&&(r+='<div class="{sparePieces} {sparePiecesTop}"></div>'),r+='<div class="{board}"></div>',e&&(r+='<div class="{sparePieces} {sparePiecesBottom}"></div>'),ee(r+="</div>",H))),t=n.find("."+H.board),u.sparePieces&&(a=n.find("."+H.sparePiecesTop),s=n.find("."+H.sparePiecesBottom));var o=Z();J("body").append(O("wP",!0,o)),i=J("#"+o),c=parseInt(t.css("borderLeftWidth"),10),p.resize()}(),function(){J("body").on("mousedown mousemove","."+H.piece,K),t.on("mousedown","."+H.square,M),n.on("mousedown","."+H.sparePieces+" ."+H.piece,D),t.on("mouseenter","."+H.square,$).on("mouseleave","."+H.square,z);var e=J(window);e.on("mousemove",X).on("mouseup",L),"ontouchstart"in document.documentElement&&(t.on("touchstart","."+H.square,j),n.on("touchstart","."+H.sparePieces+" ."+H.piece,Q),e.on("touchmove",Y).on("touchend",U))}(),p},window.ChessBoard=window.Chessboard,window.Chessboard.fenToObj=ie,window.Chessboard.objToFen=pe}(),"undefined"!=typeof exports&&(exports.Chessboard=window.Chessboard);
